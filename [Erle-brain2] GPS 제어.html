<html>
<head>
  <title>[Erle-brain2] GPS 제어</title>
  <basefont face="나눔고딕" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303244 (ko-KR, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 나눔고딕;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1651"/>
<h1>[Erle-brain2] GPS 제어</h1>

<div>
<span><div><br/></div><div><span style="color: rgb(204, 153, 255);"><b><span style="font-size: 24px;">1. GPS 제어</span></b></span></div><div><br/></div><div>파라미터 설정 관련: <a href="https://dronecode.github.io/MAVProxy/html/uav_configuration/parameters.html" rev="en_rl_minimal">참고1</a>  <a href="https://dronecode.github.io/MAVProxy/html/uav_configuration/parameters.html" rev="en_rl_small">참고2</a> </div><div><br/></div><div><span style="font-size: 24px;"><b><span style="color: rgb(255, 156, 0);">Simulator</span></b></span><br/></div><div><b>param show</b>                              현재 APM상의 모든 파라미터 리스트 출력</div><div>param set [파라미터명] [값]        파라미터 값 설정</div><div>param show *[검색어]*              검색어가 들어간 파라미터 출력. ( [검색어]* : 검색어로 시작하는 파라미터, *[검색어] : 검색어로 끝나는 파라미터)</div><div>param download                      인터넷에서 파라미터 정의 문서 다운로드</div><div>param help [파라미터명]             해당 파라미터의 정보(용법, 노트) 보여줌. (param download가 선행되어야 함. 모든 파라미터 정보가 있지는 않음. 예컨대 아래서 쓸 SIM_GPS_DISABLE 도 없음)</div><div><br/></div><div><b><span style="color: rgb(51, 102, 255);">param set SIM_GPS_DISABLE 1</span></b>   <b>GPS 사용 중지</b> (losing GPS lock)</div><div>                                                       : 콘솔창 상단 첫줄에서 결과 확인 가능 <span style="color: rgb(153, 204, 0);"><b>GPS:OK(10)</b></span> =&gt; <b><span style="color: rgb(255, 0, 0);">GPS:1(3)</span></b></div><div>cf. GPS Failsafe : GPS가 필요한 모드*에서 5초 이상 GPS 사용에 장애가 생기면 Land 모드로 초기화됨. <a href="http://ardupilot.org/copter/docs/archived-gps-failsafe.html" rev="en_rl_minimal">참고</a></div><div>(시뮬레이터에서 Guided 모드로 드론 띄워놓고 GPS 풀면, 5초 뒤에 자동으로 Land 모드로 바뀌어 착륙함)</div><div>* <a href="[APM] Flight mode.html" rev="en_rl_minimal">[APM] Flight mode</a> <a href="http://ardupilot.org/copter/docs/flight-modes.html" rev="en_rl_minimal">참고1</a> <a href="http://www.internetmap.kr/entry/APMCompter-Flight-Mode" rev="en_rl_minimal">참고2</a><br/></div><table border="0" cellspacing="0" style="width:100%;"><tr><td height="17" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000;width:50%;"><div style="text-align: center">GPS lock 필요모드</div></td><td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000;width:50%;"><div style="text-align: center">GPS lock 불필요모드</div></td></tr><tr><td height="17" style="border-left: 1px solid #000000; border-right: 1px solid #000000"><div style="text-align: center">Loiter</div></td><td style="border-left: 1px solid #000000; border-right: 1px solid #000000"><div style="text-align: center">Stabilize</div></td></tr><tr><td height="17" style="border-left: 1px solid #000000; border-right: 1px solid #000000"><div style="text-align: center">RTL</div></td><td style="border-left: 1px solid #000000; border-right: 1px solid #000000"><div style="text-align: center">Alt Hold</div></td></tr><tr><td height="17" style="border-left: 1px solid #000000; border-right: 1px solid #000000"><div style="text-align: center">Auto</div></td><td style="border-left: 1px solid #000000; border-right: 1px solid #000000"><div style="text-align: center">Acro</div></td></tr><tr><td height="17" style="border-left: 1px solid #000000; border-right: 1px solid #000000"><div style="text-align: center">Guided</div></td><td style="border-left: 1px solid #000000; border-right: 1px solid #000000"><div style="text-align: center">Sport</div></td></tr><tr><td height="17" style="border-left: 1px solid #000000; border-right: 1px solid #000000"><div style="text-align: center">Drift</div></td><td style="border-left: 1px solid #000000; border-right: 1px solid #000000"><div style="text-align: center">Land</div></td></tr><tr><td height="17" style="border-left: 1px solid #000000; border-right: 1px solid #000000"><div style="text-align: center">PosHold</div></td><td style="border-left: 1px solid #000000; border-right: 1px solid #000000"><div style="text-align: center"><br/></div></td></tr><tr><td height="17" style="border-left: 1px solid #000000; border-right: 1px solid #000000"><div style="text-align: center">Follow Me</div></td><td style="border-left: 1px solid #000000; border-right: 1px solid #000000"><div style="text-align: center"><br/></div></td></tr><tr><td height="17" style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"><div style="text-align: center">Circle</div></td><td align="left" style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"><div style="text-align: center"><br/></div></td></tr></table><div><br/></div><div>그러나, 모드만 GPS lock 불필요모드로 변경해서는 이륙하지 않음.</div><div>GPS 관련 파라미터를 Disabled 해줘야 함. <a href="http://daddynkidsmakers.blogspot.kr/2016_02_01_archive.html" rev="en_rl_minimal">참고1</a> <a href="http://diydrones.com/forum/topics/can-iris-quadcopter-fly-indoor" rev="en_rl_minimal">참고2</a></div><div><br/></div><div><br/></div><div><span style="font-size: 24px;"><span style="color: rgb(255, 156, 0);"><b>Erle-Jack/Jill</b></span></span></div><div><b>GPS를 사용 중지시키는 파라미터</b>가 있는지 <b><span style="color: rgb(51, 102, 255);">확인 안됨</span></b>. 다음은 전체 파라미터 리스트 중 GPS로 검색한 것들임</div><div><img src="[Erle-brain2] GPS 제어_files/gps_e.png" type="image/png" style="height: auto;"/></div><div><br/></div><div><br/></div><div><span style="color: rgb(204, 153, 255);"><b><span style="font-size: 24px;">2. GPS 없이 이륙takeoff시키기</span></b></span></div><div><br/></div><div><span style="color: rgb(0, 128, 128);"><span style="font-size: 24px;"><b>1) 파라미터 옵션 조작</b></span></span></div><div><br/></div><div><span style="font-size: 24px;"><b><span style="color: rgb(255, 156, 0);">Simulator</span></b></span><br/></div><div>(1) 윈도우 기반의 <span style="color: rgb(0, 0, 255);"><b><u>미션플래너</u></b></span>에서는 다음 화면과 같이 params 설정시 <u><b><span style="color: rgb(0, 0, 255);">ALT_HOLD 모드로 이륙 가능</span></b></u>하다고 함.<span style="color: rgb(255, 156, 0);">(확인 요망)</span></div><div><img src="[Erle-brain2] GPS 제어_files/gps.png" type="image/png" style="height: auto;"/><br/></div><div>params 설정 :</div><div>- ARMING_CHECK : Skip GPS</div><div>- GPS Failsafe Enable(FS_GPS_ENABLE) : Disabled</div><div>- GPS Glitch protection enable/disable(GPSGLITCH_ENABLE) : Disabled</div><div><br/></div><div>(2) <span style="color: rgb(0, 0, 255);"><b><u>APM Planner</u></b></span>에서는 위의 방법은 <span style="color: rgb(0, 0, 255);"><b><u>사용할 수 없음</u></b></span></div><div>     a. Standard Params, Advanced Params 창에 아무것도 없음</div><div>          - 창을 보이게 하려면 apm planner를 닫고, 터미널에서 다음 명령(한줄임) 입력 후 apm planner 재실행. <a href="http://discuss.ardupilot.org/t/apm-planner-2-0-18-standard-params-missing-mac-o-s/7932/15" rev="en_rl_minimal">참고</a></div><div>          rm ~/apmplanner2/apm.pdef.xml; curl 'http://autotest.ardupilot.org/Parameters/apm.pdef.xml' -o ~/apmplanner2/apm.pdef.xml; chmod 400 ./apmplanner2/apm.pdef.xml</div><div>     b. 윗 명령으로 창이 보이게 되어도, ARMING_CHECK 설정만 있음. (filter에서 GPS로 검색)</div><div>          - 파라미터 목록에 처음부터 FS_GPS_ENABLE, GPSGLITCH_ENABLE이 없음</div><div>     c. <b>ARMING_CHECK만 skip GPS로 설정해서는</b> 여전히 <span style="color: rgb(0, 0, 255);"><u><b>ALT_HOLD 모드에서 이륙 안됨</b></u></span></div><div><span style="font-size: 14px;"><span style="font-family: gotham, helvetica, arial, sans-serif;"><br/></span></span></div><div><span style="font-size: 14px;"><span style="font-family: gotham, helvetica, arial, sans-serif;">cf. <a href="http://ardupilot.org/copter/docs/prearm_safety_check.html" rev="en_rl_minimal">에러메시지 의미</a></span></span></div><div style="font-family:gotham, helvetica, arial, sans-serif;font-size:14px;"><br/></div><div style="font-family:gotham, helvetica, arial, sans-serif;font-size:14px;"><br/></div><div style="font-family:gotham, helvetica, arial, sans-serif;font-size:14px;"><span style="font-size: 24px;"><span style="color: rgb(255, 156, 0);"><b>Erle-Jack/Jill</b></span></span></div><div>APM Planner에 연결시켜 확인해보면, 위와 마찬가지로</div><div><b><span style="color: rgb(0, 0, 0);">ARMING_CHECK만 skip GPS로 설정해서는</span></b>, 여전히 <u><b><span style="color: rgb(0, 0, 255);">ALT_HOLD 모드에서 이륙 안됨</span></b></u></div><div><br/></div><div><br/></div><div><span style="font-size: 24px;"><span style="color: rgb(0, 128, 128);"><span style="font-family: gotham, helvetica, arial, sans-serif;"><b>2) RC overriding</b></span></span></span></div><div><a href="http://forum.erlerobotics.com/t/first-ros-takeoffland-program-runs-but-no-drone-movement/1205/13" rev="en_rl_small">참고</a></div><div><br/></div><div><span style="font-size: 24px;font-family:gotham, helvetica, arial, sans-serif;"><b><span style="color: rgb(255, 156, 0);">Simulator</span></b></span></div><div>비 GPS 모드에서 ARM되지 않음.</div><div>하지만 <span style="color: rgb(0, 0, 255);"><u><b>Geo Fence를 사용해제</b></u></span>하면 <span style="color: rgb(0, 0, 255);"><u><b>ARM</b></u></span>시킬 수 있음.</div><div>방법: 1) <u><b>mavproxy 창</b></u>에서 <span style="color: rgb(0, 0, 255);"><u><b>fence disable</b></u></span> 입력. 2) APM Planner의 CONFIG/TUNING &gt; GeoFence 탭에서 Geo Fence 사용해제. 3) GUI 콘솔 창에서 제어 <a href="https://dronecode.github.io/MAVProxy/html/uav_configuration/geofence.html">출처</a></div><div><br/></div><div>Armed되고 나면, <span style="color: rgb(0, 0, 255);"><u><b>rc 채널 값을 조작해 이륙 가능</b></u></span>.</div><div>rc 1    Roll</div><div>rc 2   Pitch</div><div>rc 3   Throttle</div><div>rc 4   Yaw</div><div>rc 5~8 할당안됨. 추후 필요한 용도로 쓸 수 있음</div><div><br/></div><div>입력값 범위 : 1000(0%) ~ 1500(50%) ~ 2000(100%)</div><div><br/></div><div>사용 예:</div><div>mode ALT_HOLD</div><div>arm throttle     시동걸기</div><div>rc 3 1600    - 이륙(위치는 고정되지 않음. 밀려다님)</div><div>rc 3 1500    - 정지</div><div>rc 3 1400    - 하강</div><div><br/></div><div><b>cf. 한번 비행한 후에는 disarm 명령이 먹히지 않음.</b></div><div style="font-family:gotham, helvetica, arial, sans-serif;font-size:14px;"><br/></div><div style="font-family:gotham, helvetica, arial, sans-serif;font-size:14px;"><span style="font-size: 24px;"><span style="color: rgb(255, 156, 0);"><b>Erle-Jack/Jill</b></span></span></div><div>비 GPS 모드에서 armed 됨(GPS 연결 없이 ALT_HOLD 모드에서 arm시켜 봄)</div><div>Armed되고 나면, <span style="color: rgb(0, 0, 255);"><u><b>rc 채널 값을 조작해 이륙 가능</b></u></span>.</div><div><br/></div><div>mode ALT_HOLD</div><div>arm throttle</div><div>rc 3 1600    - 이륙(모터가 가속됨)</div><div>rc 3 1500    - 정지</div><div>rc 3 1400    - 하강</div><div style="font-family:gotham, helvetica, arial, sans-serif;font-size:14px;"><span style="font-family: &quot;Helvetica Neue&quot;, Arial, sans;"><span style="font-size: 16px;"><br/></span></span></div><div style="font-family:&quot;Helvetica Neue&quot;, Arial, sans;font-size:16px;"><br/></div><div style="font-family:gotham, helvetica, arial, sans-serif;font-size:14px;"><br/></div><div><b><span style="font-size: 24px;"><span style="color: rgb(255, 156, 0);"><br/></span></span></b></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><br/><br/><br/><br/></span>
</div></body></html> 