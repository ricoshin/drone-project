<html>
<head>
  <title>[ROS] Gentle Introduction to ROS</title>
  <basefont face="나눔고딕" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303244 (ko-KR, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 나눔고딕;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1799"/>
<h1>[ROS] Gentle Introduction to ROS</h1>

<div><span><div>메타 운영체제는 운영체제 위에서 동작하면서 런타임에 다른 프로세스(노드)들끼리 서로 통신할 수 있도록 해준다.</div><div>When spoken aloud, the name &quot;ROS&quot; is nearly always pronounced as a single word that rhymes with &quot;moss&quot;, and alomost never spelled out &quot;arrr-oh-ess.&quot;</div><div>ROS는 &quot;알-오-에스&quot;라고 부르지 않고 &quot;로스&quot;라고 부른다.</div><div><br/></div><div><b>rosdep</b></div><div><font color="#010101"><span style="font-size:11pt">os에 독립적으로 패키지 dependency들을 체크하고 설치해주는 도구. apt-get의 프론트 엔드처럼 작동. 직접 사용하지 않고 다른 도구들에 의해서 뒷단에서 실행됨.</span></font></div><div align="left" style="min-height: 12pt;"><div><span style="font-size: 11pt;"><span style="color: rgb(1, 1, 1);"><br/></span></span></div><div><b><font color="#010101"><span style="font-size:11pt">sudo rosdep init</span></font></b></div><div><font color="#010101"><span style="font-size:11pt">시스템 전체에 대한 세팅이므로 sudo 붙여줘야 함. 처음 한번하고 해줄 필요 없음.</span></font></div><div><span style="font-size: 15px;"><span style="color: rgb(1, 1, 1);"><br/></span></span></div><div><b><span style="color: rgb(1, 1, 1);"><span style="font-size: 15px;">rosdep update</span></span></b></div><div><span style="color: rgb(1, 1, 1);"><span style="font-size: 15px;">각각의 사용자 계정에 대하여 실행. ~/.ros폴더를 만들고 안에 몇몇 파일을 저장함. 사용 중인 사용자 계정을 사용하여 실행. (sudo 붙이지 않음.) 일반적으로 한번만 하면 할 필요 없음.</span></span></div></div><div><br/></div><div align="left" style="min-height: 12pt;"><div><b><font color="#010101"><span style="font-size:11pt">source /opt/ros/indigo/setup.bash</span></font></b></div><div>ROS실행에 필요한 파일의 경로를 저장하는 환경 변수 세팅해줌. 모든 ROS 환경변수는 export | grep ROS로 확인 가능.</div><div>setup.bash 안에는 환경 변수 뿐만아니라, rposcd나 rosls와 같은 명령어를 구현하기 위한 bash 함수들도 정의되어 있음. 이러한 함수들은 rosbash패키지 안에 정의되어 있음.</div><div><br/></div><div><b>source {catkin workspace}/devel/setup.bash</b></div><div>글로벌 setup.bash와 유사하지만 워크스페이스에 특별히 맞추어진 버전이라고 보면 된다. </div><div>ROS가 당신의 패키지와 새로 생성된 실행파일을 찾을 수 있다록 해주는 몇가지 환경 변수들을 세팅해준다.</div><div>한번만 source해주면 코드를 수정하거나 재컴파일 하더라도 다시 할 필요는 없다. (경로만 그대로라면 새로 빌드를 하더라도 여전히 찾을 수 있다.)</div><div>단, 새로운 패키지를 빌드했거나 디렉토리 구조가 변경되면 다시 실행해줘야 한다.</div><div><br/></div><div>&quot;모든&quot; ROS 소프트웨어는 다른 혹은 그 이상의 패키지의 일부라고 해도 과언이 아니다.</div><div>사용자가 직접 생성하는 새로운 프로그램도 역시 예외가 아니다!</div><div><br/></div><div><b>package directory</b></div><div>모든 패키지는 package.xml이라고 불리는 메니페스트 파일에 의해 정의됨.</div><div>package.xml 파일을 포함하고 있는 디렉토리라면 모두 '패키지 디렉토리'로 간주함. rospack list 명령어로 설치된 모든 ROS 패키지를 볼 수 있음.</div><div>이 디렉토리에 대부분의 패키지 파일들이 저장됨. 새로운 캣킨 빌드 시스템에서는 예외임. 컴파일된 실행파일이 패키지 디렉토리에 저장되지 않고 다른 별개의 정해진 위치에 저장됨.</div><div><br/></div><div><br/></div><div>패키지가 apt-get에 의해 설치되면,  /opt/ros/indigo에 파일들이 설치됨.</div><div>하위 디렉토리 중 lib에는 실행파일이 저장됨. 유사하게 자동으로 생성된 include 파일들은 include 디렉토리 안에 저장됨.</div><div>ROS는 CMAKE_PREFIX_PATH 환경 변수안에 나열되어 있는 디렉토리를 검색하여 이 파일들을 찾을 수 있다.</div><div>CMAKE_PREFIX_PATH는 setup.bash에 의해 자동으로 세팅됨. </div><div>이러한 일종의 out-of-source 컴파일 방식은 캣킨 빌드시스템에 적용된 주요 변화 중 하나이다.</div><div>그러나 일반적으로는 모든 것들은 배후에서 일어나며, 우리는 ROS가 필요할때 이 파일을들 찾아줄 것이라고 믿으면 된다. </div><div><br/></div><div>stack은 관련된 패키지들의 컬렉션이다.</div><div>groovy버전 이후로는 stack이라는 개념 대신에 meta-package라는 개념을 사용한다.</div><div>가장 큰 차이는 계층을 없앴다는 점이다. 스택은 서브 디렉토리에 다른 패키지를 포함하고 있어 계층적이다.</div><div>그러나, 메타패키지는 일반 패키지와 같이 메니페스트를 갖는 하나의 패키지에 불과하며, 하위 디렉토리에 다른 패키지를 포함하고 있지도 않다.</div><div><br/></div><div>roscore를 멈추어야 할 경우 : 새로운 로그 파일들로 바꾸고자 할때. 파라미터 서버를 클리어하고자 할때.</div><div><br/></div><div>대부분의 ROS 노드는 시작할때만 마스터에 연결되고, 그 후에 연결이 끊어지더라도 재연결을 시도하지 않음.</div><div>그러므로 roscore를 중간에 멈추게 되면, 그 때 구동중이던 노드들은 모두 마스터와의 연결이 끊어진 상태를 유지하게 됨.</div><div>추후에 roscore를 다시 재시작하더라도 새로운 연결을 수립할 수 없음.</div><div><br/></div><div><br/></div><div>rosrun turtlesim turtlesim_node 명령어는 내부적으로 다음과 같다.</div><div align="left" style="min-height: 12pt;"><div><font color="#010101"><span style="font-size:11pt">/opt/ros/indigo/lib/turtlesim/turtlesim_node</span></font></div><div><span style="font-size: 11pt;"><span style="color: rgb(1, 1, 1);">단순히 패키지 이름을 가지고 실행파일을 찾아내어 실행해주는 쉘 스크립트일 뿐이다.</span></span></div><div>노드를 마스터에 등록하는 일 등은 이 명령에서 일어나는 것이 아니라, 프로그램 안에서 일어난다.</div><div><br/></div><div>/rosout이라는 이름의 토픽도 있고, 노드도 있다. 그러나 ROS는 이 둘을 혼동하지 않음. 문맥상 항상 분명한 상황에서 각각의 이름을 사용하기 때문임.</div><div><br/></div><div>보통은 하나의 ROS워크스페이스를 사용하는 것이 일만적이지만, 캣킨 빌드 시스템에서는 하나의 워크스페이스 안의 패키지를 한번에 빌드하려고 하기 때문에,</div><div>만약 많은 패키지나 몇가지 다른 프로젝트들에 대해 작업하고 있다면, 개별적인 워크스페이스 여러 개를 관리하는 것도 유용할 수 있다.</div><div><br/></div><div><b>catkin_create_pkg</b> : 단순히 파캐지를 담을 디렉토리를 만들고 package.xml과 CMakeLists.txt를 생성함.</div><div>package.xml의 내용은 ROS에 의해 직접 이용되지 않는다. 패키지를 다른 사용자들을 위해 릴리즈하고자 할때 비로소 중요해지는 내용들이다.</div><div>실제 기능과 다큐멘테이션의 싱크를 맞춰주기 위해 채워줘야할 최소한의 필드는 description과 maintainter 정도이다.</div><div>build_depend나 run_depend와 같은 필드에 디펜던시를 제대로 써주지 않는다 해도 빌드 과정에서는 에러가 없다.</div><div>다만 다른 사용자가 당신의 패키지를 다운받아서, 필요한 패키지가 인스톨되어있지 않은 상태로 빌드를 시도할 경우에는 에러 메세지를 보게 될 것이다.</div><div><br/></div><div>src디렉토리 없이 바로 패키지 디렉토리 아래에 소스파일을 만들어도 관계는 없다. src디렉토리가 반드시 필요한 것은 아니다.</div><div><br/></div><div>CMakeLists.txt의 find_package()에 패키지를 선언해주는 목적은 catkin이 C++컴파일러에게 적절한 플래그를 제공하도록 하는데 있다.</div><div>이 플래그는 필요한 헤더파일과 라이브러리의 위치를 알려주는 역할을 한다.</div><div>여기서 선언된 라이브러리 리스트는 ${catkin_LIBRARIES}에 저장되며, </div><div>target_link_libraries(excutable_name &amp;{catkin_LIBRARIES})와 같이 지정해주면 </div><div>실행파일을 링크할때 해당 라이브러리 플래그를 사용하게 된다.</div><div><br/></div><div>메세지 타입에 관련하여, ROS 필드 타입은 C++ 타입에 정확히 매핑된다. </div><div>단 하나 조금 다른 점은 rosmsg show에서 []으로 표현되는 배열 타입은 C++코드에서는 STL 벡터로 인식된다는 것이다.</div><div><br/></div><div>*node 종료할때 ctrl+C를 하고 바로 사라지지 않으면 rosnode cleanup 사용하거나, 애초에  rosnode kill을 이용해서 종료하는 방법 고려해 볼것.</div><div>*tum_ardrone 모두 실행해 놓고 rqt_graph를 통해 확인해볼 것.</div></div><div><font color="#010101"><span style="font-size:11pt">*rosmsg show</span></font> <font color="#010101"><span style="font-size:11pt">message-type-name</span></font></div><div><span style="font-size: 11pt;"><span style="color: rgb(1, 1, 1);">*roswtf</span></span></div><div><span style="font-size: 11pt;"><span style="color: rgb(1, 1, 1);"><br/></span></span></div><div><span style="font-size: 11pt;"><span style="color: rgb(1, 1, 1);"><br/></span></span></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></div></span>
</div></body></html> 